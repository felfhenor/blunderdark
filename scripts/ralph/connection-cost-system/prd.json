{
  "project": "Blunderdark",
  "branchName": "ralph/connection-cost-system",
  "description": "Connection Cost System - Manage hallway construction costs (5 Crystals per tile) with validation, preview, and deduction.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Implement hallway cost calculation function",
      "description": "As a developer, I want a function that calculates the Crystal cost of a hallway path.",
      "acceptanceCriteria": [
        "A function calculateHallwayCost(path) returns path.length * 5",
        "Returns 0 for an empty path",
        "Unit tests verify cost calculation for various path lengths",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Implement resource validation on build",
      "description": "As the system, I want to validate that the player has enough Crystals before allowing hallway construction.",
      "acceptanceCriteria": [
        "Before building, system checks currentCrystals >= hallwayCost",
        "If insufficient, build is rejected with error notification",
        "Confirm button is disabled when resources are insufficient",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Implement resource deduction on confirm",
      "description": "As the system, I want to deduct the hallway cost from Crystal balance when building is confirmed.",
      "acceptanceCriteria": [
        "On confirmation, currentCrystals -= hallwayCost via ResourceManager",
        "Deduction happens atomically with hallway creation",
        "Resource display updates immediately after deduction",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Display cost preview during hallway placement",
      "description": "As a dungeon builder, I want to see the hallway cost before confirming.",
      "acceptanceCriteria": [
        "Hallway placement preview shows 'Cost: X Crystals' where X = tiles * 5",
        "Cost updates dynamically if the path changes",
        "Player's current Crystal balance shown alongside the cost",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Ensure direct adjacency connections are free",
      "description": "As a dungeon builder, I want direct adjacency connections to be free.",
      "acceptanceCriteria": [
        "Creating a direct adjacency connection does not deduct any resources",
        "UI does not show a cost for adjacency connections",
        "No resource validation performed for adjacency connections",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    }
  ]
}
