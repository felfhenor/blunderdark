{
  "project": "Blunderdark",
  "branchName": "ralph/seasonal-events",
  "description": "Seasonal events system with 10-15 random occurrences triggered during specific seasons, offering bonuses, challenges, and player choices",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define Seasonal Event Data Structure",
      "description": "As a developer, I want a typed event data structure so that events are well-defined and data-driven",
      "acceptanceCriteria": [
        "A SeasonalEvent type is defined with fields: id, name, description, season, effects, choices (optional), duration, weight",
        "An EventEffect type supports: resource gains/losses, stat modifiers, creature spawns, and flags",
        "An EventChoice type supports: label, description, and effects for each option",
        "Types use type keyword per project conventions",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "SeasonalEventContent, EventEffect, EventChoice types defined in content-seasonalevent.ts; SeasonalEventState, ActiveSeasonalEffect, PendingSeasonalEvent in seasonal-event.ts"
    },
    {
      "id": "US-002",
      "title": "Define Growth Season Events",
      "description": "As a developer, I want 3-4 events defined for the Growth season",
      "acceptanceCriteria": [
        "Bumper Crop event: +50 Food bonus, lasts 1 day",
        "Wild Growth event: Nature rooms produce double for 2 days but attract invaders",
        "Healing Spring event: All inhabitants heal 20% HP",
        "Events are defined in YAML in gamedata/events/growth.yaml",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "3 growth events: Verdant Bloom (+40 food, +30% food production 3d), Crystal Seedlings (choice: 60 crystals or +25% crystal prod 5d), Migrating Creatures (choice: 25 essence or trade food for gold). Adapted from PRD spec to fit resource_gain/loss/production_modifier effect types."
    },
    {
      "id": "US-003",
      "title": "Define Harvest Season Events",
      "description": "As a developer, I want 3-4 events defined for the Harvest season",
      "acceptanceCriteria": [
        "Rich Merchant event: Merchant offers rare items at discount",
        "Tax Collector event: Lose 10% Gold or fight off the collector",
        "Bountiful Harvest event: +100 of each resource",
        "Events are defined in YAML in gamedata/events/harvest.yaml",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "3 harvest events: Bountiful Harvest (+60 food, +30 gold), Ancient Artifacts (choice: 50 research or 150 gold), Tax Collector (choice: pay 80 gold or refuse for corruption + gold production boost). Adapted from PRD spec to fit available effect types."
    },
    {
      "id": "US-004",
      "title": "Define Darkness Season Events",
      "description": "As a developer, I want 3-4 events defined for the Darkness season",
      "acceptanceCriteria": [
        "Demonic Visitor event: Opportunity to recruit a rare demon with choice to recruit or reject",
        "Shadow Rift event: Random room gains +3 Corruption, may spawn shadow creatures",
        "Undead Rising event: Free skeleton reinforcements appear",
        "Eclipse event: All dark creatures gain +2 Attack for 1 day",
        "Events are defined in YAML",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "4 darkness events: Shadow Rift (+30 essence, +10 corruption), Dark Whispers (choice: research+corruption or seal for crystals), Cursed Offering (choice: gold->essence or flux->reduce corruption production), Corruption Surge (+20 corruption, +40% essence prod 3d). Adapted to use resource effects rather than creature spawns."
    },
    {
      "id": "US-005",
      "title": "Define Storms Season Events",
      "description": "As a developer, I want 3-4 events defined for the Storms season",
      "acceptanceCriteria": [
        "Lightning Strike event: Random room takes damage but generates burst of Flux",
        "Arcane Storm event: All magic rooms produce double for 1 day",
        "Cave-In event: Random hallway is blocked, must be repaired",
        "Energy Surge event: Research progress jumps 10%",
        "Events are defined in YAML",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "4 storms events: Flux Storm (+35 flux, -20% crystal prod 2d), Lightning Strike (choice: crystals+flux or research+research boost), Arcane Convergence (+50% flux prod, +30% essence prod 3d), Tunnel Collapse (choice: food->gold+crystals or +15% food prod 4d). Adapted to use resource effects."
    },
    {
      "id": "US-006",
      "title": "Random Event Trigger System",
      "description": "As a developer, I want events to trigger randomly during appropriate seasons so that gameplay has variety",
      "acceptanceCriteria": [
        "Each game day during a season, there is a configurable chance (e.g. 30%) to trigger an event",
        "Events are selected from the pool matching the current season",
        "Selection uses weighted random based on the event's weight property",
        "The same event cannot trigger twice in the same season cycle",
        "Event triggering is integrated into the game loop day-transition handler",
        "Unit tests verify probability distribution and season filtering",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "seasonalEventProcess called each tick in gameloop. 30% daily trigger chance. Weighted selection, season filtering, cycle reset, no-repeat per cycle. 26 unit tests covering all functions."
    },
    {
      "id": "US-007",
      "title": "Event Effect Application",
      "description": "As a developer, I want event effects applied correctly to the game state",
      "acceptanceCriteria": [
        "Resource gain/loss effects modify the resource state immediately",
        "Stat modifier effects are applied for the event's duration then removed",
        "Creature spawn effects add inhabitants to the dungeon",
        "Timed effects track their remaining duration and expire correctly",
        "Unit tests verify each effect type",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "seasonalEventApplyEffects handles resource_gain (capped at max), resource_loss (flat or percentage, floor 0), production_modifier (adds ActiveSeasonalEffect with duration). Production formula integrates via seasonalEventGetProductionModifier multiplier. Active effects tick down daily and expire."
    },
    {
      "id": "US-008",
      "title": "Event Notification UI",
      "description": "As a player, I want event notifications to appear so that I know what is happening and can make choices",
      "acceptanceCriteria": [
        "When an event triggers, a notification panel/modal appears",
        "The notification shows the event name, description, and effects",
        "If the event has choices, buttons for each option are displayed",
        "Choosing an option applies its effects and dismisses the notification",
        "Events without choices have a Dismiss button that applies the default effect",
        "The notification component is standalone with OnPush change detection",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "PanelSeasonalEventComponent with modal auto-opens on pending event. Shows season badge, name, flavor text, effects with color-coded badges. Choice events show buttons with effect previews. Non-choice events have Acknowledge button. Active effects shown in sidebar card with remaining days."
    }
  ]
}
