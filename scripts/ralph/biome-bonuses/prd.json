{
  "project": "Blunderdark",
  "branchName": "ralph/biome-bonuses",
  "description": "Biome Bonuses - Automatic production bonuses based on floor biome and room type pairings.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define biome bonus data",
      "description": "As a developer, I want biome bonuses defined as data so that they are maintainable and testable.",
      "acceptanceCriteria": [
        "Define bonus rules: biome type -> room type -> percentage bonus",
        "Volcanic: Forges +50% efficiency",
        "Flooded: Lakes +50% production",
        "Crystal Cave: Mines +40% output",
        "Corrupted: Dark rooms +100% Corruption generation",
        "Fungal: Groves +60% output",
        "Neutral: No bonuses",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "BIOME_ROOM_BONUSES exported from production-modifiers.ts. Volcanic: Dark Forge +50%, Crystal Mine +15%. Fungal: Mushroom Grove +60%. Crystal: Crystal Mine +40%, Ley Line Nexus +10%. Corrupted: Soul Well +100%, Shadow Library +100%. Flooded: Underground Lake +50%. Neutral has no entry."
    },
    {
      "id": "US-002",
      "title": "Implement biome bonus computation helper",
      "description": "As a developer, I want a helper function to compute biome bonuses so that logic is testable.",
      "acceptanceCriteria": [
        "Create getBiomeBonus(biome, roomType) returning the multiplier (e.g., 1.5 for +50%)",
        "Returns 1.0 for rooms not affected by the biome",
        "Returns 1.0 for neutral biome",
        "Function is pure",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "getBiomeBonus(biome, roomTypeId) in production-modifiers.ts. Pure function, returns 1.0 + bonus or 1.0 for no match/neutral."
    },
    {
      "id": "US-003",
      "title": "Apply biome bonuses to production system",
      "description": "As a developer, I want biome bonuses to integrate with the resource production system.",
      "acceptanceCriteria": [
        "Biome bonuses applied as multipliers tagged with source 'biome'",
        "Only rooms matching the biome's bonus room type receive the bonus",
        "Bonuses stack multiplicatively with other modifier sources",
        "Bonuses apply automatically (no player action needed)",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Already integrated in conditional-production-modifiers (10.2). Biome modifier is in the MODIFIER_REGISTRY with type 'biome', evaluated automatically via calculateProductionModifiers(context). Stacks multiplicatively with time-of-day and floor-depth modifiers."
    },
    {
      "id": "US-004",
      "title": "Display biome bonuses in UI",
      "description": "As a player, I want to see biome bonuses for the current floor so that I understand the benefits.",
      "acceptanceCriteria": [
        "Show biome bonus in room detail panel when a room benefits from the biome",
        "Display format: 'Biome Bonus: +50% (Volcanic)' next to production values",
        "Show biome bonuses in floor info panel as a summary",
        "Component uses OnPush change detection",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": false,
      "notes": "Deferred — UI display requires panel components that don't exist yet. The data layer (getBiomeBonus, evaluateModifiers) is ready for UI consumption."
    },
    {
      "id": "US-005",
      "title": "Add biome bonus unit tests",
      "description": "As a developer, I want tests for biome bonus calculations.",
      "acceptanceCriteria": [
        "Test: Forge on Volcanic floor returns 1.5 multiplier",
        "Test: Lake on Flooded floor returns 1.5 multiplier",
        "Test: Mine on Crystal Cave floor returns 1.4 multiplier",
        "Test: Non-matching room returns 1.0 multiplier",
        "Test: Neutral biome returns 1.0 for all rooms",
        "Tests in src/app/helpers/biome-bonuses.spec.ts",
        "All tests pass with npm run test",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Tests in production-modifiers.spec.ts (not separate file — biome bonuses are part of the production modifier system). 22 new tests covering getBiomeBonus, BIOME_ROOM_BONUSES, and updated biome modifier integration tests. All 1389 tests pass."
    }
  ]
}
