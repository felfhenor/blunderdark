# PRD: Corruption Resource

## Introduction
Corruption is a special resource tracked alongside standard resources. It is generated by dark rooms and creatures, can be spent on dark upgrades and features, and triggers escalating effects at high levels. Unlike other resources, high Corruption has negative consequences, creating a risk/reward dynamic.

## Goals
- Track Corruption as a resource in the ResourceManager
- Generate Corruption from dark rooms and creatures
- Allow spending Corruption on dark upgrades
- Trigger effects at high Corruption levels
- Display Corruption in the resource UI with warnings

## User Stories

### US-001: Corruption Resource Tracking
**Description:** As a developer, I want Corruption tracked as a resource so that it can be generated, spent, and queried like other resources.

**Acceptance Criteria:**
- [ ] Add `corruption` to the resource system (ResourceManager or equivalent)
- [ ] Corruption is a number starting at 0
- [ ] Corruption has no hard cap (can grow indefinitely)
- [ ] Support `addCorruption(amount: number)` and `spendCorruption(amount: number)` methods
- [ ] Corruption cannot go below 0
- [ ] Typecheck/lint passes

### US-002: Corruption Signal
**Description:** As a developer, I want Corruption exposed as a signal so that UI and other systems react to changes.

**Acceptance Criteria:**
- [ ] `corruption` signal available from the resource service
- [ ] `corruptionLevel` computed signal returning threshold category (`'low' | 'medium' | 'high' | 'critical'`)
- [ ] Low: 0-49, Medium: 50-99, High: 100-199, Critical: 200+
- [ ] Typecheck/lint passes

### US-003: Corruption UI Display
**Description:** As a player, I want to see my Corruption level in the resource panel so that I can monitor it.

**Acceptance Criteria:**
- [ ] Show Corruption value in the resource display area
- [ ] Color-coded: green (low), yellow (medium), orange (high), red (critical)
- [ ] Show warning icon when Corruption reaches medium or above
- [ ] Tooltip explains Corruption effects at current level
- [ ] Component uses OnPush change detection
- [ ] Typecheck/lint passes
- [ ] **[UI story]** Verify in browser using dev-browser skill

### US-004: Corruption Persistence
**Description:** As a developer, I want Corruption to persist with game state so that it survives save/load.

**Acceptance Criteria:**
- [ ] Corruption value persisted to IndexedDB as part of resource state
- [ ] Restored on game load
- [ ] Default to 0 for new games or missing data
- [ ] Typecheck/lint passes

### US-005: Corruption Spending Interface
**Description:** As a player, I want to spend Corruption on dark upgrades so that high Corruption has strategic value.

**Acceptance Criteria:**
- [ ] Dark upgrades/features list Corruption as a cost
- [ ] Spending Corruption reduces the current level
- [ ] Cannot spend more Corruption than currently available
- [ ] Spending UI shows current Corruption and cost
- [ ] Typecheck/lint passes

## Functional Requirements
- FR-1: Corruption must be tracked as a numeric resource starting at 0.
- FR-2: Corruption must be addable, spendable, and queryable.
- FR-3: Corruption level must be categorized into thresholds (low, medium, high, critical).
- FR-4: Corruption must be displayed in the resource UI with color-coded warnings.
- FR-5: Corruption must persist across game sessions.

## Non-Goals (Out of Scope)
- Corruption generation rates (covered by #55)
- Corruption effects/events (covered by #56)
- Corruption threshold triggers (covered by #57)
- Corruption reduction mechanics (future feature)

## Technical Considerations
- Depends on Room Placement (#7) and Inhabitant System (#10) as sources of Corruption
- Extend existing resource system rather than creating a separate tracking mechanism
- Corruption types in `src/app/interfaces/`
- Consider whether Corruption should be per-floor or global (recommend global initially)

## Success Metrics
- Corruption tracks correctly as resources are generated and spent
- UI clearly communicates current Corruption level and risk
- Persistence works correctly across save/load
- Threshold categories compute correctly

## Open Questions
- Should Corruption be per-floor or global?
- Is there a Corruption decay rate over time?
- Should there be a way to "purify" Corruption outside of spending it?
