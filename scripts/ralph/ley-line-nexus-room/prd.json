{
  "project": "Blunderdark",
  "branchName": "ralph/ley-line-nexus-room",
  "description": "Ley Line Nexus Room - A T-shaped magical room that generates 10 Flux/min, amplifies nearby magic rooms by +30%, can only be placed on ley line convergence points, supports 2-3 inhabitants.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define Ley Line Nexus in YAML gamedata",
      "description": "As a developer, I want the Ley Line Nexus defined in YAML with T-shaped layout and production values.",
      "acceptanceCriteria": [
        "ley-line-nexus.yaml in gamedata/rooms/ with id, name, description, shape (T-shaped ~9 tiles), fearLevel (2 medium), maxInhabitants (2), upgradeMaxInhabitants (3)",
        "Production: 10 Flux per minute base rate",
        "Placement restriction: requiresLeyLine: true",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Implement T-shaped placement with ley line convergence check",
      "description": "As a player, I want the Nexus to occupy a T-shaped footprint and only be placeable on ley line convergence points.",
      "acceptanceCriteria": [
        "T-shaped room occupying ~9 tiles integrates with existing shape system",
        "Each dungeon floor has pre-generated ley line convergence points from world generation",
        "Nexus can only be placed when footprint overlaps a convergence point",
        "Placement UI highlights valid ley line positions",
        "Attempting to place on non-ley-line tile rejected with message",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Implement Flux production and magic amplification aura",
      "description": "As a developer, I want the Nexus to produce Flux and boost nearby magic rooms by +30%.",
      "acceptanceCriteria": [
        "Room produces 10 Flux/min base, +2 Flux per assigned inhabitant",
        "All magic-tagged rooms within 3 grid spaces (Manhattan distance) receive +30% production",
        "Multiple Nexus auras do not stack on the same room (max +30%)",
        "Aura recalculates when rooms are added/removed; implemented as computed() signal",
        "Production paused if room damaged or has no inhabitants",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Write Ley Line Nexus unit tests",
      "description": "As a developer, I want tests verifying Nexus production, amplification, and placement.",
      "acceptanceCriteria": [
        "Test: Nexus produces 10 Flux/min base",
        "Test: Magic amplification +30% to eligible rooms within 3 spaces",
        "Test: Amplification does not apply to non-magic rooms",
        "Test: Multiple Nexus auras do not stack",
        "Test: Placement rejected on non-ley-line tiles",
        "Test: Inhabitant capacity respects base and upgraded limits",
        "Tests in src/app/helpers/ spec file",
        "All tests pass with npm run test",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    }
  ]
}
