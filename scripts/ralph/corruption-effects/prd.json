{
  "project": "Blunderdark",
  "branchName": "ralph/corruption-effects",
  "description": "Corruption Effects - Escalating effects at Corruption thresholds: dark upgrades at 50, mutations at 100, Crusade invasion at 200.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Implement dark upgrade unlock at 50 Corruption",
      "description": "As a player, I want dark upgrades to unlock at 50 Corruption so that embracing Corruption has rewards.",
      "acceptanceCriteria": [
        "When Corruption reaches 50, unlock a set of dark upgrade options",
        "Dark upgrades are visible but locked below 50 Corruption",
        "Upgrades remain unlocked even if Corruption drops below 50",
        "Show notification when dark upgrades become available",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Added requiresDarkUpgrade field to RoomUpgradePath, 4 dark upgrade YAML definitions, roomUpgradeGetVisible() for UI, NotifyService wiring"
    },
    {
      "id": "US-002",
      "title": "Implement random mutations at 100 Corruption",
      "description": "As a player, I want inhabitants to gain random mutations at 100 Corruption.",
      "acceptanceCriteria": [
        "At 100 Corruption, trigger a mutation event on a random inhabitant",
        "Mutations can be positive (stat boost) or negative (stat reduction)",
        "Mutation is permanent on the affected inhabitant",
        "Show notification describing the mutation and affected inhabitant",
        "Mutation events can repeat each time 100 threshold is re-crossed",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Pre-existing implementation in corruption-effects.ts with full test coverage. Notification wiring added via NotifyService."
    },
    {
      "id": "US-003",
      "title": "Implement Crusade invasion at 200 Corruption",
      "description": "As a developer, I want a Crusade invasion to trigger at 200 Corruption.",
      "acceptanceCriteria": [
        "When Corruption reaches 200, trigger a special Crusade invasion event",
        "Crusade is stronger than normal scheduled invasions",
        "Show prominent warning before the Crusade begins",
        "Crusade can only trigger once per threshold crossing",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Pre-existing implementation in corruption-effects.ts with full test coverage. Uses invasionTriggerAddSpecial('crusade'). Warning notification wired via NotifyService."
    },
    {
      "id": "US-004",
      "title": "Implement visual corruption effects",
      "description": "As a player, I want the dungeon to look increasingly corrupted as Corruption rises.",
      "acceptanceCriteria": [
        "Low (0-49): No visual effects",
        "Medium (50-99): Subtle dark tinting on dungeon edges",
        "High (100-199): Purple/dark veins on tiles, particle effects",
        "Critical (200+): Heavy corruption overlay, pulsing effects",
        "Effects scale smoothly between thresholds",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CSS-only visual effects using data-corruption attribute on grid container. Inset box-shadows, radial gradients, and keyframe animation for pulsing at critical level."
    },
    {
      "id": "US-005",
      "title": "Implement corruption effect notifications",
      "description": "As a player, I want clear notifications when Corruption effects trigger.",
      "acceptanceCriteria": [
        "Notification at 50: dark upgrades available",
        "Notification at 100: inhabitant mutation",
        "Notification at 200: Crusade approaching",
        "Notifications are dismissible and logged in message history",
        "Component uses OnPush change detection",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "NotifyService subscribes to corruptionEffectEvent$ and shows toastr notifications for all three event types. Crusade uses warning style, others use info. All are tap-to-dismiss."
    }
  ]
}
