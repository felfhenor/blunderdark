{
  "project": "Blunderdark",
  "branchName": "ralph/research-tree-data-structure",
  "description": "Research tree data structure defining three branches (Dark, Arcane, Engineering) with 10-15 nodes each, compiled from YAML through the content pipeline",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define Research Node Type",
      "description": "As a developer, I want a well-typed research node data structure so that each node has all necessary properties",
      "acceptanceCriteria": [
        "A ResearchNode type is defined in src/app/interfaces/ with fields: id, name, description, branch, cost, prerequisites, unlocks, tier",
        "A ResearchBranch type is defined as a union: 'dark' | 'arcane' | 'engineering'",
        "A ResearchTree type is defined containing all nodes organized by branch",
        "Types use type keyword per project conventions",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "ResearchBranch, ResearchNode, ResearchTree types in src/app/interfaces/research.ts; cost uses ResourceCost from resource.ts"
    },
    {
      "id": "US-002",
      "title": "Define Research State Type",
      "description": "As a developer, I want a research state type so that player progress through the tree can be tracked and persisted",
      "acceptanceCriteria": [
        "A ResearchState type is defined with fields: completedNodes (array of node IDs), activeResearch (node ID or null), activeResearchProgress (number 0-1), activeResearchStartTick (number)",
        "The type is added to GameStateWorld in state-game.ts",
        "The type is JSON-serializable (no Set, Map, or class instances)",
        "Unit tests verify serialization round-trip",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "ResearchState added to GameStateWorld, defaultResearchState() in defaults.ts, JSON-serializable (plain arrays and primitives)"
    },
    {
      "id": "US-003",
      "title": "Define YAML Schema for Research Nodes",
      "description": "As a developer, I want research nodes defined in YAML files so that they compile through the content pipeline",
      "acceptanceCriteria": [
        "A YAML schema for research nodes is defined in gamedata/research/ directory",
        "Each YAML file contains research nodes with all required fields",
        "npm run gamedata:build compiles the YAML without errors",
        "npm run schemas:generate produces matching TypeScript types",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Created gamedata/research/base.yml with 3 root nodes (one per branch). Added 'research' to ContentType and ensureResearch initializer. Build and schema generation pass."
    },
    {
      "id": "US-004",
      "title": "Define Dark Branch Nodes",
      "description": "As a developer, I want the Dark research branch defined with 10-15 nodes covering dark magic, undead, and corruption",
      "acceptanceCriteria": [
        "10-15 nodes are defined for the Dark branch in YAML",
        "Nodes include Dark Arts, Soul Manipulation, Undead Mastery, Corruption Control, Soul Well, Shadow Magic, Necromancy, Dark Rituals, Abyssal Gateway and more",
        "Each node has a clear prerequisite chain forming a tree structure",
        "Costs are balanced with early nodes cheap and later nodes expensive",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Define Arcane Branch Nodes",
      "description": "As a developer, I want the Arcane research branch defined with 10-15 nodes covering magic, flux, and ley lines",
      "acceptanceCriteria": [
        "10-15 nodes are defined for the Arcane branch in YAML",
        "Nodes include Arcane Basics, Flux Manipulation, Ley Line Tapping, Enchantment, Warding, Elemental Binding, Arcane Amplification, Dimensional Studies and more",
        "Each node has prerequisites forming a tree structure",
        "Costs scale appropriately with tier depth",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Define Engineering Branch Nodes",
      "description": "As a developer, I want the Engineering research branch defined with 10-15 nodes covering construction, traps, and manufacturing",
      "acceptanceCriteria": [
        "10-15 nodes are defined for the Engineering branch in YAML",
        "Nodes include Basic Engineering, Advanced Construction, Trap Design, Advanced Manufacturing, Siege Works, Automated Defenses, Dark Forge, Master Architecture and more",
        "Each node has prerequisites forming a tree structure",
        "Costs scale appropriately with tier depth",
        "npm run gamedata:build compiles without errors",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Research Tree Validation",
      "description": "As a developer, I want build-time validation of the research tree so that invalid data is caught before runtime",
      "acceptanceCriteria": [
        "A validation script checks that all prerequisite references point to valid node IDs",
        "Circular dependency detection prevents infinite prerequisite loops",
        "Every branch has at least one root node with no prerequisites",
        "Validation runs as part of npm run gamedata:build",
        "Clear error messages for invalid data",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    }
  ]
}
