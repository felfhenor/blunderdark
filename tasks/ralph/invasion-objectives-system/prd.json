{
  "project": "Blunderdark",
  "branchName": "ralph/invasion-objectives-system",
  "description": "Invasion Objectives System - Gives invading parties specific objectives: a primary Destroy Altar objective plus 2 randomly selected secondary objectives (Slay Monster, Rescue Prisoner, Steal Treasure, Seal Portal, etc.) with progress tracking and victory resolution.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define objective data model and types",
      "description": "As a developer, I want an objective data model so that objectives can be defined, assigned, and tracked.",
      "acceptanceCriteria": [
        "InvasionObjective type with fields: id, type, name, description, targetId, isPrimary, isCompleted, progress (0-100)",
        "ObjectiveType enum: DestroyAltar, SlayMonster, RescuePrisoner, StealTreasure, SealPortal, DefileLibrary, PlunderVault, ScoutDungeon",
        "Types defined in src/app/interfaces/invasion-objective.ts using type keyword",
        "Types exported via barrel export at @interfaces",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Implement objective assignment with primary and secondary selection",
      "description": "As a developer, I want objectives assigned per invasion with 1 primary (Destroy Altar) and 2 random secondary objectives.",
      "acceptanceCriteria": [
        "assignInvasionObjectives(state, seed): InvasionObjective[] helper function",
        "Always includes Destroy Altar as primary objective",
        "Selects 2 secondary objectives from eligible pool based on game state prerequisites",
        "Objectives only eligible if prerequisites met (e.g., Rescue Prisoner requires prisoners, Steal Treasure requires Vault)",
        "Seed ensures deterministic selection; no duplicate objective types",
        "Secondary objectives include: SlayMonster (targets Tier 2+ inhabitant), RescuePrisoner, StealTreasure, SealPortal",
        "Helper in src/app/helpers/invasion-objectives.ts",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Implement objective progress tracking and victory resolution",
      "description": "As a developer, I want objective progress tracked during invasion and outcomes determined by completion.",
      "acceptanceCriteria": [
        "Each objective has progress (0-100%) exposed as a signal for reactive UI",
        "SlayMonster: progress = target HP lost %; StealTreasure: progress = gold looted / target; SealPortal: progress = turns spent / required",
        "Altar destruction = total defeat regardless of other outcomes",
        "Invaders retreat or all killed with Altar intact = defense success",
        "Secondary completion by invaders reduces defense rewards; preventing all grants bonus",
        "resolveInvasionOutcome(objectives): InvasionResult helper function",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Create objective display UI during invasions",
      "description": "As a player, I want to see current invasion objectives so that I know what invaders are trying to accomplish.",
      "acceptanceCriteria": [
        "Objectives panel displayed during invasion mode",
        "Primary objective shown prominently at top",
        "2 secondary objectives shown below with progress bars",
        "Completed objectives show checkmark; failed show X",
        "Objective targets highlighted on dungeon map",
        "Component uses OnPush change detection",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Write comprehensive objective system unit tests",
      "description": "As a developer, I want tests for objective assignment, progress, and resolution.",
      "acceptanceCriteria": [
        "Test: Primary objective always assigned",
        "Test: Exactly 2 secondary objectives assigned",
        "Test: Ineligible objectives excluded from pool",
        "Test: No duplicate objective types in same invasion",
        "Test: Altar destruction = defeat",
        "Test: All invaders killed with Altar intact = victory",
        "Test: Objective progress updates correctly",
        "Tests in src/app/helpers/invasion-objectives.spec.ts",
        "All tests pass with npm run test",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    }
  ]
}
