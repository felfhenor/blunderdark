{
  "project": "Blunderdark",
  "branchName": "ralph/reputation-effects",
  "description": "Reputation effects system that gives gameplay consequences to reputation levels, unlocking rooms, attracting creatures, modifying event rates, and altering dungeon dynamics",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define Reputation Effects Data Structure",
      "description": "As a developer, I want a data-driven reputation effects configuration so that designers can tune effects without code changes",
      "acceptanceCriteria": [
        "A ReputationEffect type is defined with fields: reputationType, minimumLevel, effectType, effectValue, description",
        "Effect types include: unlock_room, modify_event_rate, attract_creature, modify_production, modify_invasion_rate",
        "A YAML file in gamedata/ defines all reputation effects",
        "The build pipeline compiles and validates the effects YAML",
        "TypeScript schema is generated for reputation effects",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Reputation Effects Engine Service",
      "description": "As a developer, I want a centralized effects engine that activates/deactivates effects based on reputation levels so that all systems query one source of truth",
      "acceptanceCriteria": [
        "A ReputationEffectsService evaluates active effects based on current reputation levels",
        "The service exposes getActiveEffects() returning all currently active effects",
        "The service exposes hasEffect(effectId) for quick checks by other systems",
        "Effects are recalculated whenever reputation changes using computed signals",
        "Other systems query this service instead of checking reputation directly",
        "Unit tests verify effect activation/deactivation at level boundaries",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Terror Effects - Dark Invasions and Torture Chamber",
      "description": "As a player with high Terror reputation, I want to see darker invasions and unlock the Torture Chamber so that my fearsome dungeon has thematic consequences",
      "acceptanceCriteria": [
        "At High Terror: invasion frequency increases by 25%",
        "At High Terror: dark invasion variant events become possible",
        "At High Terror: Torture Chamber room is unlocked for construction",
        "At Legendary Terror: dark invasion frequency doubles",
        "Effects are removed if Terror drops below High",
        "Unit tests verify Terror threshold triggers",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Wealth Effects - Thieves and Treasure Vault",
      "description": "As a player with high Wealth reputation, I want thief events and Treasure Vault upgrades so that hoarding gold has risks and rewards",
      "acceptanceCriteria": [
        "At High Wealth: thief raid events become possible that steal Gold if undefended",
        "At High Wealth: Treasure Vault room upgrades are unlocked",
        "At Legendary Wealth: Gold production bonus of +10% across all rooms",
        "Thief events scale in difficulty with Wealth level",
        "Effects are removed if Wealth drops below High",
        "Unit tests verify Wealth threshold triggers",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Knowledge Effects - Advanced Research",
      "description": "As a player with high Knowledge reputation, I want access to advanced research options so that scholarly pursuits are rewarded",
      "acceptanceCriteria": [
        "At High Knowledge: advanced research tier is unlocked in the research system",
        "At High Knowledge: research speed increases by 15%",
        "At Legendary Knowledge: unique forbidden knowledge research branch unlocks",
        "Effects are removed if Knowledge drops below High",
        "Unit tests verify Knowledge threshold triggers",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Harmony Effects - Peaceful Creatures and Reduced Invasions",
      "description": "As a player with high Harmony reputation, I want peaceful creatures to arrive and fewer invasions so that a benevolent dungeon is viable",
      "acceptanceCriteria": [
        "At High Harmony: invasion frequency decreases by 30%",
        "At High Harmony: peaceful creature recruitment events trigger periodically",
        "At Legendary Harmony: invasions reduced by 50% and unique peaceful creatures available",
        "Peaceful creatures have distinct types defined in gamedata",
        "Effects are removed if Harmony drops below High",
        "Unit tests verify Harmony threshold triggers",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Chaos Effects - Random Events and Unpredictable Bonuses",
      "description": "As a player with high Chaos reputation, I want increased random events and unpredictable bonuses so that embracing chaos feels exciting and risky",
      "acceptanceCriteria": [
        "At High Chaos: random event frequency increases by 50%",
        "At High Chaos: events have a 20% chance to give double rewards or double penalties",
        "At Legendary Chaos: chaos surge events trigger that can dramatically alter dungeon state",
        "Random events pulled from a weighted event pool defined in gamedata",
        "Effects are removed if Chaos drops below High",
        "Unit tests verify Chaos threshold triggers",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Active Effects Display UI",
      "description": "As a player, I want to see which reputation effects are currently active so that I understand how my reputation is influencing gameplay",
      "acceptanceCriteria": [
        "An Active Effects section appears in the reputation panel",
        "Each active effect shows: icon, name, brief description, source reputation",
        "Effects appear/disappear dynamically as reputation levels change",
        "Hovering an effect shows detailed tooltip with exact modifiers",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    }
  ]
}
