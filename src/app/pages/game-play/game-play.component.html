<div class="game-container relative flex flex-col">
  <div class="resource-bar-container px-4 pt-2 pb-1 flex-shrink-0">
    <div class="flex items-center gap-4">
      <app-panel-resources class="flex-1" />
      <div class="floor-indicator text-xs font-mono opacity-70 whitespace-nowrap">
        Floor {{ currentFloorDepth() }} / {{ totalFloors() }}
      </div>
    </div>
    <app-morale-bar />
  </div>
  <div class="flex gap-4 flex-1 min-h-0">
  <div class="sidebar w-64 flex-shrink-0 flex flex-col gap-4 overflow-y-auto">
    <app-panel-floor-selector />
    <app-panel-floor-minimap />
    <app-panel-roster />
    <app-panel-merchant />
    @if (canShowFusion()) {
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body p-4">
          <h3 class="card-title text-sm">Fusion Chamber</h3>
          <p class="text-xs opacity-50">Combine two creatures into a hybrid.</p>
          <button class="btn btn-xs btn-secondary" (click)="showFusion.set(true)">
            Open Fusion
          </button>
        </div>
      </div>
    }
    <app-panel-room-info />
    <app-panel-hallway-info />
    <app-panel-stair-info />
    <app-panel-elevator-info />
    <app-panel-portal-info />
    <app-synergy-tooltip />
    <app-panel-training-grounds />
    <app-panel-breeding-pits />
    <app-panel-summoning-circle />
    <app-panel-dark-forge />
    <app-panel-alchemy-lab />
    <app-panel-torture-chamber />
    <app-panel-altar />
    <app-panel-throne-room />
    <app-panel-research-summary (openResearch)="showResearch.set(true)" />
    <app-panel-room-select />
    <app-panel-reputation />
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body p-4">
        <div class="flex items-center justify-between">
          <h3 class="card-title text-sm">Victory Paths</h3>
          <button class="btn btn-xs btn-outline" (click)="showVictoryMenu.set(true)">
            Open
          </button>
        </div>
        <p class="text-xs opacity-50">Track your progress toward victory.</p>
      </div>
    </div>
  </div>
  <div class="flex-1 overflow-auto">
    <app-grid />
  </div>
  </div>
</div>

<app-game-research [(visible)]="showResearch" />
<app-panel-fusion [(visible)]="showFusion" />
<app-panel-victory />
<app-victory-menu [(visible)]="showVictoryMenu" />

<ng-container [appTeleportOutlet]="'menu-options'"></ng-container>
